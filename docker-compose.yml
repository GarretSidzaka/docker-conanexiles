services:
  ce0:
    image: garretsidzaka/docker-conanexiles:latest
    container_name: ce0
    depends_on:
      - redis
    restart: unless-stopped
    environment:
      # server settings
      - "CONANEXILES_CMDSWITCHES='-Port=7777 -QueryPort=27020'"
      - "CONANEXILES_SERVER_TYPE=pvp"
      - "CONANEXILES_ServerSettings_ServerSettings_AdminPassword=agoodpassword"
      #custom map file
      #- "CONANEXILES_Engine_/Script/EngineSettings.GameMapsSettings_ServerDefaultMap=/Game/Mods/Savage_Wilds/Savage_Wilds"
      - "CONANEXILES_ServerSettings_ServerSettings_IsVACEnabled=True"
      - "CONANEXILES_ServerSettings_ServerSettings_IsBattlEyeEnabled=True"
      - "CONANEXILES_ServerSettings_ServerSettings_serverRegion=1"
      - "CONANEXILES_PORT=7777"
      - "CONANEXILES_QUERYPORT=27020"
      - "CONANEXILES_Engine_OnlineSubSystemSteam_ServerName=MySingleServer"
      - "CONANEXILES_INSTANCENAME=MySingleInstance"
      - "CONANEXILES_Game_RconPlugin_RconEnabled=1"
      - "CONANEXILES_Game_RconPlugin_RconPassword=agoodpassword"
      - "CONANEXILES_Game_RconPlugin_RconPort=25575"
      - "CONANEXILES_Game_RconPlugin_RconMaxKarma=60"
      - "CONANEXILES_UPDATE_SHUTDOWN_TIMER=15"
      - "CONANEXILES_ServerSettings_ServerSettings_CorpsesPerPlayer=3"
      - "CONANEXILES_ServerSettings_ServerSettings_MaxDeathMapMarkers=3"
      - "CONANEXILES_ServerSettings_ServerSettings_DropEquipmentOnDeath=1"
      - "CONANEXILES_ServerSettings_ServerSettings_EverybodyCanLootCorpse=True"
      # Installed Mods
      #880454836 Pippi Server manager
      #1823412793 mod control panel
      - "CONANEXILES_MODS=880454836,1823412793"   
      # logging
      - "CONANEXILES_Engine_Core.Log_LogStreaming=Error"
      - "CONANEXILES_Engine_Core.Log_GlobalServerChannel=Error"
      - "CONANEXILES_Engine_Core.Log_ConanBattlePass=Fatal"
      - "CONANEXILES_Engine_Core.Log_SpawnTable=Error"
      - "CONANEXILES_Engine_Core.Log_LogScriptCore=Error"
      - "CONANEXILES_Engine_Core.Log_Network=Error"
      - "CONANEXILES_Engine_Core.Log_LogNetPackageMap=Error"
      - "CONANEXILES_Engine_Core.Log_LogModController=Error"
      # Very Good Defaults
      - "CONANEXILES_Engine_/script/onlinesubsystemutils.ipnetdriver_NetServerMaxTickRate=30" #INSERT A VALUE OF 30 OR HIGHER
      - "CONANEXILES_Engine_/script/onlinesubsystemutils.ipnetdriver_MaxClientRate=100000"
      - "CONANEXILES_Engine_/script/onlinesubsystemutils.ipnetdriver_MaxInternetClientRate=100000"
      - "CONANEXILES_Engine_/script/aimodule.crowdmanager_NavmeshCheckInterval=0.500000"
      - "CONANEXILES_Engine_/script/aimodule.crowdmanager_PathOptimizationInterval=0.500000"
      - "CONANEXILES_Engine_/script/aimodule.crowdmanager_bResolveCollisions=True"
      - "CONANEXILES_Engine_/script/aimodule.aisystem_bAllowStrafing=True"
      - "CONANEXILES_Engine_/script/engine.audiosettings_bAllowCenterChannel3DPanning=True"
      - "CONANEXILES_Engine_SystemSettings_dw.NetClientFloatsDuringNavWalking=0"
      - "CONANEXILES_ServerSettings_ServerSettings_NetworkSimulatedSmoothRotationTimeWithLQAVP=0.100000"
      - "CONANEXILES_ServerSettings_ServerSettings_NPCRespawnMultiplier=1.000000"
      - "CONANEXILES_ServerSettings_ServerSettings_NPCMaxSpawnCapMultiplier=1.000000 "
      - "CONANEXILES_Game_/script/engine.gamenetworkmanager_TotalNetBandwidth=80000000"
      - "CONANEXILES_Game_/script/engine.gamenetworkmanager_MaxDynamicBandwidth=100000"
      - "CONANEXILES_Game_/script/engine.gamenetworkmanager_MinDynamicBandwidth=10000"
      - "CONANEXILES_Game_/script/engine.gamenetworkmanager_MoveRepSize=512.0f"
      - "CONANEXILES_Game_/script/engine.gamenetworkmanager_MAXPOSITIONERRORSQUARED=3.0f"
      - "CONANEXILES_Game_/script/engine.gamenetworkmanager_MAXCLIENTUPDATEINTERVAL=0.25f"
      - "CONANEXILES_Game_/script/engine.gamenetworkmanager_MaxMoveDeltaTime=0.125f"
      - "CONANEXILES_Game_/script/engine.gamenetworkmanager_MaxClientSmoothingDeltaTime=1.0f"
      - "CONANEXILES_Game_/script/engine.gamenetworkmanager_ClientAuthorativePosition=true"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.EnableAISpawning=1"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.EnableInitialAISpawningPass=1"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.NPCsTargetBuildings=1"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.nav.AvoidNonPawns=1"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.EnableStaticRoamingPaths=1"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.nav.InterpolateAvoidanceResult=1"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.AILOD1Distance=4000"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.AILOD2Distance=8000"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.AILOD3Distance=11500"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.SkeletalMeshTickRate=0.2"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.NpcLOD2ListenServerControllerTickRate=20.f"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.NpcLOD3ListenServerControllerTickRate=20.f"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.NpcLOD3ListenServerBehaviorTickRate=20.f"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.NpcLOD2ListenServerMovementTickRate=2.0f"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.NpcLOD3ListenServerMovementTickRate=20.f"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.NpcLOD2ControllerTickRate=20.f"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.NpcLOD3ControllerTickRate=20.f"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.NpcLOD3BehaviorTickRate=20.f"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.NpcLOD2MovementTickRate=2.0f"
      - "CONANEXILES_Engine_/script/conansandbox.systemsettings_dw.NpcLOD3MovementTickRate=20.f"
      - "CONANEXILES_Scalability_AntiAliasingQuality@0_r.MSAA.CompositingSampleCount=0"
      - "CONANEXILES_Scalability_AntiAliasingQuality@1_r.MSAA.CompositingSampleCount=2"
      - "CONANEXILES_Scalability_AntiAliasingQuality@2_r.MSAA.CompositingSampleCount=4"
      - "CONANEXILES_Scalability_AntiAliasingQuality@3_r.MSAA.CompositingSampleCount=4"
      - "CONANEXILES_Scalability_ViewDistanceQuality@0_r.ViewDistanceScale=3.4"
      - "CONANEXILES_Scalability_ViewDistanceQuality@1_r.ViewDistanceScale=3.6"
      - "CONANEXILES_Scalability_ViewDistanceQuality@2_r.ViewDistanceScale=3.8"
      - "CONANEXILES_Scalability_ViewDistanceQuality@3_r.ViewDistanceScale=4.0"
      - "CONANEXILES_Scalability_ShadowQuality@0_r.Shadow.CSM.MaxCascades=1"
      - "CONANEXILES_Scalability_ShadowQuality@0_r.Shadow.MaxResolution=512"
      - "CONANEXILES_Scalability_ShadowQuality@0_r.Shadow.DistanceScale=0.6"
      - "CONANEXILES_Scalability_ShadowQuality@0_r.Shadow.MaxPointCasters=0"
      - "CONANEXILES_Scalability_ShadowQuality@0_r.Shadow.CSMDepthBias=30"
      - "CONANEXILES_Scalability_ShadowQuality@1_r.Shadow.CSM.MaxCascades=1"
      - "CONANEXILES_Scalability_ShadowQuality@1_r.Shadow.RadiusThreshold=0.05"
      - "CONANEXILES_Scalability_ShadowQuality@1_r.Shadow.DistanceScale=0.7"
      - "CONANEXILES_Scalability_ShadowQuality@1_r.Shadow.MaxPointCasters=0"
      - "CONANEXILES_Scalability_ShadowQuality@1_r.Shadow.CSMDepthBias=25"
      - "CONANEXILES_Scalability_ShadowQuality@2_r.DistanceFieldAO=1"
      - "CONANEXILES_Scalability_ShadowQuality@2_r.Shadow.MaxPointCasters=1"
      - "CONANEXILES_Scalability_ShadowQuality@2_r.Shadow.CSMDepthBias=20"
      - "CONANEXILES_Scalability_ShadowQuality@3_r.Shadow.CSM.MaxCascades=10"
      - "CONANEXILES_Scalability_ShadowQuality@3_r.Shadow.CSM.TransitionScale=2"
      - "CONANEXILES_Scalability_ShadowQuality@3_r.Shadow.CSMDepthBias=100"
      - "CONANEXILES_Scalability_ShadowQuality@3_r.Shadow.MaxResolution=4096"
      - "CONANEXILES_Scalability_ShadowQuality@3_r.Shadow.FadeExponent=0"
      - "CONANEXILES_Scalability_ShadowQuality@3_r.Shadow.Faderesolution=1024"
      - "CONANEXILES_Scalability_ShadowQuality@3_r.DistanceFieldAO=1"
      - "CONANEXILES_Scalability_ShadowQuality@3_r.Shadow.PerObjectDirectionalDepthBias=10000"
      - "CONANEXILES_Scalability_ShadowQuality@3_r.Shadow.PointLightDepthBias=10000"
      - "CONANEXILES_Scalability_ShadowQuality@3_r.Shadow.SpotLightDepthBias=10000"
      - "CONANEXILES_Scalability_PostProcessQuality@0_r.AllowLandscapeShadows=0"
      - "CONANEXILES_Scalability_PostProcessQuality@0_r.HighQualityLightMaps=0"
      - "CONANEXILES_Scalability_PostProcessQuality@0_r.TonemapperQuality=1"
      - "CONANEXILES_Scalability_PostProcessQuality@1_r.AllowLandscapeShadows=0"
      - "CONANEXILES_Scalability_PostProcessQuality@1_r.HighQualityLightMaps=0"
      - "CONANEXILES_Scalability_PostProcessQuality@1_r.TonemapperQuality=1"
      - "CONANEXILES_Scalability_PostProcessQuality@2_r.BloomQuality=4"
      - "CONANEXILES_Scalability_PostProcessQuality@2_r.TonemapperQuality=1"
      - "CONANEXILES_Scalability_PostProcessQuality@3_r.AmbientOcclusionLevels=2"
      - "CONANEXILES_Scalability_PostProcessQuality@3_r.DepthOfFieldQuality=4"
      - "CONANEXILES_Scalability_PostProcessQuality@3_r.RenderTargetPoolMin=1000"
      - "CONANEXILES_Scalability_PostProcessQuality@3_r.LensFlareQuality=3"
      - "CONANEXILES_Scalability_PostProcessQuality@3_r.EyeAdaptationQuality=3"
      - "CONANEXILES_Scalability_PostProcessQuality@3_r.Bloom.Cross=1"
      - "CONANEXILES_Scalability_PostProcessQuality@3_r.Tonemapper.Quality=1"
      - "CONANEXILES_Scalability_PostProcessQuality@3_r.Tonemapper.Sharpen=0.2"
      - "CONANEXILES_Scalability_PostProcessQuality@3_r.ReflectionEnvironmentLightmapMixLargestWeight=7500"
      - "CONANEXILES_Scalability_TextureQuality@0_r.Streaming.LimitPoolSizeToVRAM=1"
      - "CONANEXILES_Scalability_TextureQuality@0_r.Streaming.PoolSize=500"
      - "CONANEXILES_Scalability_TextureQuality@1_r.Streaming.LimitPoolSizeToVRAM=1"
      - "CONANEXILES_Scalability_TextureQuality@1_r.Streaming.PoolSize=800"
      - "CONANEXILES_Scalability_TextureQuality@2_r.Streaming.LimitPoolSizeToVRAM=1"
      - "CONANEXILES_Scalability_TextureQuality@2_r.Streaming.PoolSize=1500"
      - "CONANEXILES_Scalability_TextureQuality@3_r.Streaming.LimitPoolSizeToVRAM=0"
      - "CONANEXILES_Scalability_TextureQuality@3_r.Streaming.PoolSize=3000"
      - "CONANEXILES_Scalability_EffectsQuality@0_r.SSS.Scale=0"
      - "CONANEXILES_Scalability_EffectsQuality@0_r.SSS.Quality=0"
      - "CONANEXILES_Scalability_EffectsQuality@0_r.SSS.HalfRes=1"
      - "CONANEXILES_Scalability_EffectsQuality@0_r.ParticleLightQuality=0"
      - "CONANEXILES_Scalability_EffectsQuality@1_r.SSS.Scale=0.75"
      - "CONANEXILES_Scalability_EffectsQuality@1_r.SSS.Quality=0"
      - "CONANEXILES_Scalability_EffectsQuality@1_r.SSS.HalfRes=1"
      - "CONANEXILES_Scalability_EffectsQuality@1_r.ParticleLightQuality=0"
      - "CONANEXILES_Scalability_EffectsQuality@2_r.ReflectionEnvironment=1"
      - "CONANEXILES_Scalability_EffectsQuality@2_r.SubsurfaceQuality=0"
      - "CONANEXILES_Scalability_EffectsQuality@2_r.SSS.Scale=1"
      - "CONANEXILES_Scalability_EffectsQuality@2_r.SSS.Quality=-1"
      - "CONANEXILES_Scalability_EffectsQuality@2_r.SSS.HalfRes=1"
      - "CONANEXILES_Scalability_EffectsQuality@2_r.ParticleLightQuality=1"
      - "CONANEXILES_Scalability_EffectsQuality@3_r.ReflectionEnvironment=1"
      - "CONANEXILES_Scalability_EffectsQuality@3_r.SubsurfaceQuality=1"
      - "CONANEXILES_Scalability_EffectsQuality@3_r.EmitterSpawnRateScale=1.5"
      - "CONANEXILES_Scalability_EffectsQuality@3_r.SSR.Quality=4"
      - "CONANEXILES_Scalability_EffectsQuality@3_r.SSS.Scale=1"
      - "CONANEXILES_Scalability_EffectsQuality@3_r.SSS.Quality=1"
      - "CONANEXILES_Scalability_EffectsQuality@3_r.SSS.HalfRes=0"
      - "CONANEXILES_Scalability_EffectsQuality@3_r.ParticleLightQuality=2"
      - "CONANEXILES_Scalability_EffectsQuality@3_r.FluidQuality=2"
      - "CONANEXILES_Scalability_GraniteTextureQuality@0_r.GraniteSDK.MipBias=1"
      - "CONANEXILES_Scalability_GraniteTextureQuality@0_r.GraniteSDK.MaxAnisotropy=1"
      - "CONANEXILES_Scalability_GraniteTextureQuality@0_r.GraniteSDK.GPUCacheSizeScale=1.0"
      - "CONANEXILES_Scalability_GraniteTextureQuality@0_r.GraniteSDK.CPUCacheSizeScale=1.0"
      - "CONANEXILES_Scalability_GraniteTextureQuality@0_r.GraniteSDK.MinGPUCacheSizeInMB=10"
      - "CONANEXILES_Scalability_GraniteTextureQuality@0_r.GraniteSDK.MinCPUCacheSizeInMB=10"
      - "CONANEXILES_Scalability_GraniteTextureQuality@1_r.GraniteSDK.MipBias=0.5"
      - "CONANEXILES_Scalability_GraniteTextureQuality@1_r.GraniteSDK.MaxAnisotropy=2"
      - "CONANEXILES_Scalability_GraniteTextureQuality@1_r.GraniteSDK.GPUCacheSizeScale=3.0"
      - "CONANEXILES_Scalability_GraniteTextureQuality@1_r.GraniteSDK.CPUCacheSizeScale=2.0"
      - "CONANEXILES_Scalability_GraniteTextureQuality@1_r.GraniteSDK.MinGPUCacheSizeInMB=10"
      - "CONANEXILES_Scalability_GraniteTextureQuality@1_r.GraniteSDK.MinCPUCacheSizeInMB=10"
      - "CONANEXILES_Scalability_GraniteTextureQuality@2_r.GraniteSDK.MipBias=0"
      - "CONANEXILES_Scalability_GraniteTextureQuality@2_r.GraniteSDK.MaxAnisotropy=4"
      - "CONANEXILES_Scalability_GraniteTextureQuality@2_r.GraniteSDK.GPUCacheSizeScale=5.0"
      - "CONANEXILES_Scalability_GraniteTextureQuality@2_r.GraniteSDK.CPUCacheSizeScale=3.0"
      - "CONANEXILES_Scalability_GraniteTextureQuality@2_r.GraniteSDK.MinGPUCacheSizeInMB=20"
      - "CONANEXILES_Scalability_GraniteTextureQuality@2_r.GraniteSDK.MinCPUCacheSizeInMB=20"
      - "CONANEXILES_Scalability_GraniteTextureQuality@3_r.GraniteSDK.MipBias=0"
      - "CONANEXILES_Scalability_GraniteTextureQuality@3_r.GraniteSDK.MaxAnisotropy=8"
      - "CONANEXILES_Scalability_GraniteTextureQuality@3_r.GraniteSDK.GPUCacheSizeScale=10.0"
      - "CONANEXILES_Scalability_GraniteTextureQuality@3_r.GraniteSDK.CPUCacheSizeScale=4.0"
      - "CONANEXILES_Scalability_GraniteTextureQuality@3_r.GraniteSDK.MinGPUCacheSizeInMB=20"
      - "CONANEXILES_Scalability_GraniteTextureQuality@3_r.GraniteSDK.MinCPUCacheSizeInMB=20 "
      - "CONANEXILES_Game_/script/conansandbox.aisenseconfig_newsight_PeripheralVisionAngleDegrees=100"
      - "CONANEXILES_Game_/script/aimodule.envquerymanager_MaxAllowedTestingTime=0.003"
      - "CONANEXILES_Game_/script/aimodule.envquerymanager_bTestQueriesUsingBreadth=false"
      - "CONANEXILES_Game_Settings.Physics.Cloth_MaxClothSimuatingActors=3"
      - "CONANEXILES_Game_Settings.Physics.Cloth_ClothSimulationAdjustmentInterval=0.650000"
      - "CONANEXILES_ServerSettings_ServerSettings_RegionBlockList="
      - "CONANEXILES_ServerSettings_ServerSettings_BuildingPreloadRadius=90"
      - "CONANEXILES_ServerSettings_ServerSettings_EnforceRotationRateWhenRoaming_2=False"
      - "CONANEXILES_ServerSettings_ServerSettings_EnforceRotationRateInCombat_2=False"
      - "CONANEXILES_ServerSettings_ServerSettings_TargetPredictionMaxSeconds=0.5"
      - "CONANEXILES_ServerSettings_ServerSettings_TargetPredictionAllowSecondsForAttack=0.2"
      - "CONANEXILES_ServerSettings_ServerSettings_PlayerKnockbackMultiplier=0.25"
      - "CONANEXILES_ServerSettings_ServerSettings_ClipVelocityOnNavmeshBoundary=True"
      - "CONANEXILES_ServerSettings_ServerSettings_ValidatePhysNavWalkWithRaycast=true"
      - "CONANEXILES_ServerSettings_ServerSettings_LocalNavMeshVisualizationFrequency=0.1"
      - "CONANEXILES_ServerSettings_ServerSettings_RotateToTargetSendsAngularVelocity=false"
      - "CONANEXILES_ServerSettings_ServerSettings_PathFollowingSendsAngularVelocity=false"
      - "CONANEXILES_ServerSettings_ServerSettings_UseLocalQuadraticAngularVelocityPrediction=false"
      - "CONANEXILES_ServerSettings_ServerSettings_LQAVPUseTime=0.150000"
      - "CONANEXILES_ServerSettings_ServerSettings_LQAVPFadeTime=0.100000"
      - "CONANEXILES_ServerSettings_ServerSettings_LQAVPMethod=2"
    ports:
      - "7777:7777/tcp"
      - "7777:7777/udp"
      - "7778:7778/tcp"
      - "7778:7778/udp"
      - "27020:27020/tcp"
      - "27020:27020/udp"
      - "25575:25575/tcp"
      - "25575:25575/udp"
    volumes:
        - conanexiles:/conanexiles
        - /etc/localtime:/etc/localtime:ro

  redis:
    image: redis:5-alpine
    container_name: redis
    restart: unless-stopped
    environment:
      - "TZ=UTC"
    volumes:
      - redis:/data/
    ports:
      - 6379:6379
  redis_insight:
    image: redislabs/redisinsight:latest
    container_name: redis_insight
    restart: unless-stopped
    ports:
      - 8001:8001
    volumes:
      - insight:/db

volumes:
  conanexiles:
  redis:
  insight:
